<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="light">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>适应度景观 | 祁观</title>
<meta name="keywords" content="">
<meta name="description" content="适应度景观是我们形象化地认识演化规律的最好隐喻。适应度景观中的远近距离、高山与峡谷，种群的在其间的移动，能很好地帮助我们想象亿万年来发生演化事件。">
<meta name="author" content="祁新">
<link rel="canonical" href="http://localhost:1313/evolution/2_%E9%80%82%E5%BA%94%E5%BA%A6%E6%99%AF%E8%A7%82/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/evolution/2_%E9%80%82%E5%BA%94%E5%BA%A6%E6%99%AF%E8%A7%82/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    }

</script>
    
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>

<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath:  [['\\(', '\\)'], ['$', '$']]     
    },
    loader:{
      load: ['ui/safe']
    },
  };
</script>
    
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="祁观 (Alt + H)">祁观</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/worldview/" title="世界观">
                    <span>世界观</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/evolution/" title="演化论">
                    <span>演化论</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="关于我">
                    <span>关于我</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      适应度景观
    </h1>
    <div class="post-meta"><span title='2024-05-28 00:00:00 +0000 UTC'>May 28, 2024</span>&nbsp;·&nbsp;<span>祁新</span>

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="http://localhost:1313/images/cover/%E9%80%82%E5%BA%94%E5%BA%A6%E6%99%AF%E8%A7%82.avif" alt="封面图片">
        
</figure><div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e6%99%af%e8%a7%82-%e6%9c%80%e5%a5%bd%e7%9a%84%e9%9a%90%e5%96%bb" aria-label="景观-最好的隐喻">景观-最好的隐喻</a></li>
                <li>
                    <a href="#%e5%ae%83%e4%b8%8d%e6%98%af%e4%b8%80%e4%b8%aa%e4%ba%ba%e5%9c%a8%e6%88%98%e6%96%97" aria-label="它不是一个人在战斗">它不是一个人在战斗</a></li>
                <li>
                    <a href="#%e8%b7%a8%e8%b6%8a%e6%99%af%e8%a7%82%e4%b8%ad%e7%9a%84%e5%b3%a1%e8%b0%b7" aria-label="跨越景观中的峡谷">跨越景观中的峡谷</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="景观-最好的隐喻">景观-最好的隐喻<a hidden class="anchor" aria-hidden="true" href="#景观-最好的隐喻">#</a></h1>
<p>适应度景观（Fitness Landscape）的概念由美国生物学家 <a href="https://zh.wikipedia.org/wiki/%E4%BC%91%E5%8E%84%E5%B0%94%C2%B7%E8%B5%96%E7%89%B9">休厄尔·赖特</a> 在1932年提出，从那时开始，这个形象有效的模型已经成了所有进化生物学家的标配工具，《自私的基因》作者理查德.道金斯称之为 <a href="https://www.amazon.co.jp/Climbing-Mount-Improbable-Richard-Dawkins/dp/0393039307">不可能之山</a>。如今，它也在人工智能、复杂问题求解等各个领域继续发挥作用，我们将一再受益于这个模型。</p>
<p>前面提过，<a href="https://zh.wikipedia.org/wiki/%E8%84%B1%E6%B0%A7%E6%A0%B8%E7%B3%96%E6%A0%B8%E9%85%B8">基因</a> 本质上是具备遗传效应的DNA上的一串字符。人类大约有两万个基因，一共30亿个字符。而最简单的病毒大概只有几个到几百个基因，每个基因大约有几千到几十万个字符。</p>
<p>假设有个简单的生物 <strong>X</strong> 病毒，它有100个基因，每个基因有100个字符。因为每个字符有四种可选的碱基（A、C，G、T），所以每个基因理论上有 $4^{100}$ 个变种，这个数大约是 $1.6 * 10^{60}$ 。那么100个基因的总共的排列方式大约是 $100! * 1.6 * 10^{60}$ ，这是一个天文数字，已经大大超过了宇宙中的原子总数。这个数表示X病毒的基因的所有可能之变异及其组合的总数。为了方便，我们用一个代号 $K$ 来表示它。</p>
<p>$K$ 中的每一个点表示X病毒的一种可能的基因组合，一般称之为<a href="https://zh.wikipedia.org/wiki/%E5%9F%BA%E5%9B%A0%E5%9E%8B">基因型</a>。我们将所有这些点，以<strong>某种连续的方式</strong>平铺在一个二维平面上。从这个平面上的点A可以走到它的相邻点B，这中间只需要基因型的一次变异，也就是其中任意一个字符的改变，使它从基因型A切换到了基因型B。这样，此平面上所有的点都无缝连续起来了。我们称这个平面为 $K$ 平面。</p>
<p>在自然选择过程中，生物都需要应对层出不穷的生存问题，X病毒也不例外。它已经被人类发明的光谱抗病毒药物Y疫苗追杀好多世代了，如果再不变异出新的抗药基因，X病毒就会灭绝。</p>
<p>X病毒的好多个基因型能够对抗Y疫苗，其中有的可以生成诱饵抢先与抗生素结合，有的修改了自己的靶点的结构使Y疫苗无法识别，有的还能够提高自己的分裂繁殖能力，如此等等。这些基因型中有的抗药性很好，有的一般般，有的还更害怕Y疫苗，只有很少数的基因型是极其有效的。</p>
<p>我们将X病毒的每个基因型的抵抗Y疫苗的有效性，作为该点的海拔高度。这样，我们就可以基于前面的 $K$ 平面，画出一个三维立体图，它像是一片有山峰与洼地的地形图。那些不太有效的基因型对应低矮的山麓，害怕Y疫苗的基因型对应着下陷的洼地，少数非常有效的基因型则是山峰。由于相邻的基因型之间只有一个字符的差别，它对于抗药性的改变非常小，所有我们看到地形是大致平滑连续的。这个地形图就是X病毒抵抗Y疫苗的适应度景观，X病毒突变到具备抗药性的过程，可以看作在这个图中爬山。</p>
<p><img loading="lazy" src="/evolution/2_%E9%80%82%E5%BA%94%E5%BA%A6%E6%99%AF%E8%A7%82/%E6%99%AF%E8%A7%82.png"></p>
<p>为什么这个地形图中有多座山峰？这个问题是深刻的。</p>
<p>一般而言，简单问题往往是由一个变量决定的，这样的问题可以明确地得到最优解，此时我们看到的地形图中会只有一个主峰，如同平原上的富士山一样。比如这个问题就是简单问题，一个班上有40名同学，请指出谁最高。但是那些<strong>复杂问题</strong>往往不是由一个变量决定，而且这些变量之间还有互相关联，这些关联还是非线性的。这样的复杂问题往往有多个可能的次优解，而且也很难判断谁是最优解。比如，这40名同学中谁最适合当班长？其中，至少一名通情达理成绩又好的乖巧的小个子女生，还有一名性格果断有执行力的高个子男生，都可能是次优解。还可能是班上不起眼的一个同学，他是校长大人的亲孙子。此时选择就很难了。</p>
<p>再例如，俾格米人和荷兰人之间的身高差别很大。身高属于多基因变异，它不是由个别基因决定的，而是同时受到数百个基因的共同作用。</p>
<p>同样的，X病毒的抗药性就属于这样的复杂问题，由于它关系到多个基因，它的地形图中会有多个山峰。</p>
<p>现在，某个X病毒的个体 $x$ 位于下图中的A点。如果它不能通过自己世代交替中的变异到爬到图中H点的高峰上，就会逐渐断子绝孙。为了简单，后面 $x$ 是指它及其它所有后代。</p>
<p>大自然是严厉的，即使万分之一的适应性改变，在多个世代之后，都会对物种后代的数量产生巨大影响。所以在自然选择的压力下 $x$ 的每一步都不能导致其海拔高度降低，也就是说 $x$ 必须走上坡路。自然选择的压力大小，可以直观想象为 $x$ 的每一步必须向上跨越的高度差。</p>
<p>从A点出发，下面紧邻着就有一个洼地，如果走到这个洼地， $x$ 马上就会被Y疫苗吞没。它最有可能的情况是沿着绿色路线走到B点，这是一个小高峰。但是 $x$ 到这里后，就没法再走了，因为B周围的点都是海拔较低的点。这样 $x$ 就卡在B点动弹不得，它要断子绝孙了&hellip;</p>
<h1 id="它不是一个人在战斗">它不是一个人在战斗<a hidden class="anchor" aria-hidden="true" href="#它不是一个人在战斗">#</a></h1>
<p>幸好， $x$ 不是一个，还有许多它的小伙伴同时生存着。由于每一个小伙伴的基因型都不完全一样，它们之间可能有着几十、几百、甚至几千个字符差别。所以我们可以想象一下，在开始的时候， $x$ 在A点，它的小伙伴在A点周围有一定距离的范围内，我们将这个范围想象为圆形好了。如果假设基因型之间单个字符的变异的跨度为一米的话，这个圆形的半径可能有几百米到几公里之间。我们将 $x$ 的所有同伴视作一个种群，称为X病毒。这样我们就可以指出，一开始时，X病毒出现在景观中以A点为中心半径为一公里的范围内。</p>
<p>进化是一个群体现象，而不是个体现象。</p>
<p>打个比方，有4种从浅到深决定人肤色的基因。小明同学只能有一种肤色，但是我们不能否认他的弟弟妹妹以及他的同学，可以有更深或者更浅的肤色。所以，这四种肤色都属于小明的族群。小明小时候在广西桂林，他肤色偏深，他同学中肤色偏深的也多。后来小明同学到东北哈尔滨读大学，他一定会发现，此时同学中肤色偏浅色的比较多。</p>
<p>小明同学进入社会后，决定做一个丁克，不要孩子了。那么小明同学的深肤色基因灭绝了吗？没有，小明的弟弟妹妹和同学们还生活在南方，他们有家庭繁育后代。</p>
<p>个体是不能长期生存的，种群才行。</p>
<p>前面假定的四种决定肤色基因，被称为等位基因。因为它们位于染色体上的同一处位置，决定着人的同一个特性，竞争上岗。</p>
<p>为了理解方便，有几个概率需要澄清一下。我们常说的基因其实更应该称之为基因座，基因座是染色体上一段固定长度的DNA，通常决定生物的某个特性。如果将染色体看作一条街道的话，你可以把基因座看成是街道上的一个门牌号码，这个地址可以由这个基因的所有等位基因来住。当然，一次只能有一位住客。当个体出生时，这条街道上的所有住客都确定好了。</p>
<p>人有46条染色体和两万多个基因。也就是说人这个城镇有46条街道，大约2万多居民。</p>
<p>每个基因座上的等位基因，在理论上是该DNA片段的所有排列组合。比如，假设一个基因长10位，由于每位可以是A、C、G、T四个字母之一，则其理论上等位基因的数量是 $4^{10}$ 个，大约一百万种。但是，由于DNA决定了酶和蛋白质的合成，这些酶和蛋白质参与了各种维系生命存续的过程。前面这一百万种理论上的等位基因中，大部分都是字符的随机组合，它们无法生产出维持正常生命过程所需要的蛋白质和酶，所有是无效的。一般而言，一个基因上大约只有几种到几百种可以正常运行的等位基因。</p>
<p>也许街道的比喻过于简单，我们这样看吧。一条染色体就相当于一条<strong>流水生产线</strong>，从头到尾，它上面的排列的基因就相当于流水线上的一个工位，每个工位都需要一名工人。这个工位上的工人是谁呢？是具备这个工位技能的一名工人 — 也就是该基因座的等位基因。有的工位只有三名特定的工人可以胜任，有的工位则有一百名工人可以干。</p>
<p>我们将种群的所有等位基因合在一起，称为基因库。种群中任何个体的基因，都是该基因库中全部基因的一部分。</p>
<p>所以，演化的实质是，一是改变种群基因库中的等位基因之多少，二是改变各个等位基因的出现<strong>频率</strong>。</p>
<p>还有一种罕见的情况是，演化中往基因库中添加了新的基因，这相当于在流水生产线上添加新工位，或者新增了一条流水线。这种情形非常罕见，每次发生都影响很大。比如20亿年前某个古菌吸纳了细菌的全套基因，将之作为自己的线粒体，从此变成了真核生物。在这种情况下，变化前后的个体之间可能产生生殖隔离，成为不同的物种。</p>
<p>现在回到X病毒上来。</p>
<p>当X病毒在演化时，不是单个病毒在行进，而是所有存活的基因型组成的病毒大军在开拔，是一个覆盖了适应度景观上几平方公里的大军团。这种演化相当于有亿万个进程的并行运算，这带来了极大的加速，使得X病毒作为种群的适应速率远远快于单一个体的爬坡速度 —— 快到好像登山者们可以俯视地图一样。</p>
<p>在这种情况下，X病毒种群会向最近的山峰快速集结，聚集到了B点。不能到达B点的X病毒，逐渐由于不能抵抗Y疫苗而灭绝了。此时我们可以说，X病毒的种群在B点。</p>
<p><img loading="lazy" src="/evolution/2_%E9%80%82%E5%BA%94%E5%BA%A6%E6%99%AF%E8%A7%82/%E6%94%80%E7%99%BB%E5%B1%B1%E5%B3%B0.png"></p>
<p><a href="https://randalolson.com/assets/2014/04/dynamic-slow.gif"><strong>这里</strong></a> 可以看到种群判断山峰的模拟动画。</p>
<p>适合度景观呈现了自然选择的作用：将一个种群推向山峰。</p>
<p>从一个山峰到达另一个更高的顶峰，也就是从一个方案过渡到另一个更好的方案，生物种群必须先跨越两座山峰之间的山谷，而自然选择是禁止这个跨越的。自然选择不懂以退为进，只会埋头爬山，很容易将种群卡在最近的山峰上。曾经的绝大部分物种，就这样只是位于局部山峰上，成为历史长河里的泡沫。</p>
<p>征服绵延的群山，自然选择必不可少，但远远不够。山峰越多，地形越崎岖，越是要有创造性的办法。</p>
<p>此时，还是休厄尔·赖特出面解决了困局。</p>
<h1 id="跨越景观中的峡谷">跨越景观中的峡谷<a hidden class="anchor" aria-hidden="true" href="#跨越景观中的峡谷">#</a></h1>
<blockquote>
<p>将欲夺之，必固与之。 - 《老子》<br>
事情在变好之前往往会先变得更糟。 - 无名氏</p>
</blockquote>
<p>话说X病毒在B山峰处艰难度日之时，由于Y疫苗的欺压，个体数量逐渐减少。某日，突然吹来一股大风，将一些X病毒吹下了山峰，散落在了B山峰的周围的山谷中，这是怎么回事？</p>
<p>这是因为 <a href="https://zh.wikipedia.org/wiki/%E4%B8%AD%E6%80%A7%E6%BC%94%E5%8C%96%E7%90%86%E8%AB%96">遗传漂变</a>。</p>
<p>打个比方，我们可以将种群的基因库看作一幅完整的画，画面上的所有像素点合在一起就是基因库的全部信息。前面说到了，X病毒有100个基因，每个基因有 \(4^{100}\)个等位基因，因为这其中绝大多数等位基因都是无效的组合，我们将之排除。假设每个基因有1000个有效等位基因，这样X病毒的基因库就相当于100 * 1000个，也就是十万个像素的一幅画，我们假设这幅画是克鲁苏的头像。</p>
<p>种群中个体的每一次繁殖，都相当于从这幅画上进行了一次随机采样。由于个体本身的基因是种群基因库的一部分，所以这一次采样是局限的，会丢失很多信息，我们可以将之想象为获得了画幅上一个像素点。好在种群中个体很多，它们的繁殖次数也很多，这就相当于对这幅画进行了很多次采样，它们的采样后的所有像素点合在一起，如果能还原出先前的那一幅画，则表示种群的基因库在世代间得到了完整延续。</p>
<p>X病毒原先还活着一亿个体，一个世代要至少进行一亿次繁殖。对一张十万个像素点的画进行一亿次采样，这几乎肯定会完整地复原那幅克鲁苏头像。</p>
<p>现在X病毒困在适应性不够强的B山峰上，缺衣少食衣不覆体，种群数量减少到了一百万。此时，每次世代更替，相当于对十万像素的画进行百万次采样，尽管采样次数还是挺大的，但是经过概率计算，每一个世代有 9.52% 的可能性丢失至少一个像素的信息。此时，克鲁苏头像就会缺失一些细节，比如有个眼睛瞎了，胡须少了一条，某处失去了颜色，等等。</p>
<p>这种基因库中随机丢失等位基因的情形，被休厄尔·赖特称之为遗传漂变。</p>
<p>漂泊过程仅仅是随机的采样误差。在没有自然选择的情况下，漂变注定走的都是下坡路。</p>
<p>遗传漂变会导致一个种群的基因库发生随机的变化，它就像方向不定的阵风，始终在吹。它是一柄双刃剑，对于在景观中艰难跋涉的登山者是干扰，但是也会触发偶然的变化。我们可以认为，由于遗传漂变，种群在景观中的位置会发生随机的位移。</p>
<p>请注意，种群的大小与遗传漂变的强度有直接关系。种群越小，漂变越强。这很好理解，前面说的采样次数越少，那副克鲁苏的头像就更早会出现缺失。</p>
<p>所以，这股妖风在种群受到威胁数量下降之时，吹得特别猛。</p>
<p>举个例子，那些热衷近亲繁殖的欧洲皇室，相当于主动减少种群数量，他们经历的就是这种情况。</p>
<p><img loading="lazy" src="/evolution/2_%E9%80%82%E5%BA%94%E5%BA%A6%E6%99%AF%E8%A7%82/%E5%93%88%E5%B8%83%E6%96%AF%E5%A0%A1%E5%A4%B4%E5%83%8F.png"></p>
<p>哈布斯堡家族是欧洲的传统王室。为了保持权力，他们经常进行近亲联姻，这使其后代出现了典型的鞋拔子脸，外加各种遗传缺陷。哈布斯堡家族所酷爱的近亲繁殖最终使得他们在西班牙和奥地利的王位绝嗣，终结了统治。</p>
<p>再回到X病毒这儿。</p>
<p><img loading="lazy" src="/evolution/2_%E9%80%82%E5%BA%94%E5%BA%A6%E6%99%AF%E8%A7%82/%E6%99%AF%E8%A7%82.png"></p>
<p>X病毒的种群在B山峰处被遗传漂变的大风吹落，散布在B山峰周围的山谷中。</p>
<p>跌落山峰的大部分个体因为适应度降低而灭亡了。好在X病毒繁殖快，突变也快，一天时间里就可以有一两次世代更新，这赋予X病毒在景观上较强的移动能力。山谷中残存的个体在自然选择的压力下，又重新开始了艰难的攀登。</p>
<p>好消息是，此时这些山谷中的X病毒同样会受到基因漂变之风的吹拂。此时，由于种群数量更少，风速更劲，大部分风向都会推着它们快速移动，尽快脱离山谷。</p>
<p>如果幸运的话，有少数个体能够从BC之间的山谷出发，登山C山峰。或者更加幸运地，极少个体从BD之间的山谷中出发，经过卓绝努力登上了D山峰。还有的X病毒甚至徒劳地又重新回到了B山峰。</p>
<p>有时候，就是要先自废武功之后，才能东山再起。短跑名将苏炳添在突破百米十秒大关之前，就曾舍弃自己过去的步伐节奏，采用了全新的起跑动作。</p>
<p>再上山峰的X病毒又会重新启动前面的过程，经历再一次上上下下的体验。</p>
<p>最终，终于有几个极其幸运的 $x$ 来到了 H 顶峰处，它们从此具备了对Y疫苗的完全抗药性。我们不能确定它们到底走得是那一条路，但是只要演化过程不停止，X病毒的种群数量够大，运气够好，它们终究会来到H顶峰。此时，它们从顶峰远眺，看到了自己的远方同胞逐渐凋零，最终灭亡，爱莫能助。</p>
<p>演化的历程难道不就是这些幸运的累积吗？代价是绝大部分个体的淘汰。但是，种群终于跨越了山谷，登上了更高峰。</p>
<p>此时，群山在望，气象万千。</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">祁观</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
