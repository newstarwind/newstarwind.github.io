[
    {{ $list := .Site.RegularPages }}
  

  
    {{ if .Site.Params.mainSections }}
        {{ $list = where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}
    {{ end }}
  
    {{ $len := (len $list) }}
    {{ range $index, $page := $list }}
    {{ if and (not $page.Draft) (not $page.Params.exclude_search) }}
    
    
   {
        "permalink": "{{ $page.RelPermalink }}",
        "title": "{{ $page.Title }}",
        "section": "{{ .Section | default "pages" }}",
        "content": {{ $page.Content | plainify | jsonify }}
   }



    {{ if lt $index (sub $len 1) }},{{ end }}
    {{ end }}
    {{ end }}
]